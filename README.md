# 智能博物项目功能库 (Yang-AI-thirdex)

**项目名称**: 智能博物项目功能库 (ZHINENFBOWU Project Function Library)  
**版本**: 0.1.0  
**作者**: YangAI  
**适用平台**: Mind+ (扩展库)  
**适用硬件**: UNIHIKER K10 (ESP32-S3)

## 📖 项目简介

这是一个为 **2026年智能博物项目** 开发的 Mind+ 第三方扩展库。它封装了 K10 设备在实现智能任务时所需的各类高级功能，包括 AI 视觉识别（人脸、OCR）、图像处理以及字符串处理工具。

主要目标是简化复杂的 API 调用和数据处理流程，让用户通过图形化积木即可轻松使用科大讯飞等 AI 服务。

## ✨ 主要功能

### 1. AI 人工智能 (XunfeiAI)
集成科大讯飞开放平台的 AI 能力：
- **OCR 文字识别**: 识别图片中的文字内容。
- **人脸/表情识别**: 检测人脸并分析面部表情（如：开心、惊讶、生气等）。

### 2. 图像处理
- **格式转换**: 支持将本地 BMP 图片转换为 JPG 格式的 Base64 字符串，以便直接用于网络 API 请求。

### 3. 工具箱 (String Utils)
针对 UTF-8 编码的中文字符串处理工具，解决 C++ 中 `String` 对多字节字符（如中文）处理不便的问题：
- **字符计数**: 正确计算包含中文的字符串长度。
- **字符获取**: 根据索引（从1开始）获取指定位置的中文字符。
- **索引查找**: 查找特定中文字符在字符串中的位置。

## 🧩 积木说明

本扩展库在 Mind+ 中提供以下积木类别：

### 初始化配置
- `设置科大讯飞文字识别 APPID[...] APIKey[...]`: 初始化 OCR 服务。
- `设置科大讯飞人脸识别 APPID[...] APIKey[...] APISecret[...]`: 初始化人脸识别服务。

### AI 识别
- `科大讯飞【OCR识别】 图片Base64[...]`: 发送图片数据，返回识别到的文本。
- `科大讯飞【表情识别】 图片Base64[...]`: 发送图片数据，返回识别到的表情描述。

### 图像工具
- `将BMP图片[...]转换为JPG Base64`: 读取本地 BMP 文件并压缩编码为 Base64。

### 字符串工具
- `中文[...]的字符数`: 返回字符串的实际字符数量（按人类阅读习惯）。
- `中文[...]的第[...]个字符`: 获取指定位置的字符。
- `中文[...]的[...]的索引`: 获取子字符串的位置。

## 🚀 快速开始

1. **安装扩展**:
   - 打开 Mind+。
   - 切换到“扩展” -> “用户库”。
   - 导入本库（git 链接或本地文件夹）。

2. **硬件准备**:
   - 连接 UNIHIKER K10 (行空板 K10) 或兼容的 ESP32-S3 开发板。
   - 确保设备已连接 Wi-Fi（AI 功能需要网络）。

3. **编写程序**:
   - 使用 `图像工具` 读取摄像头拍摄的照片或本地图片。
   - 使用 `AI 识别` 积木调用云端服务。
   - 使用 `字符串工具` 处理返回的文本结果。

## 📂 目录结构

- `arduinoC/`: 核心 C++ 源码及库文件。
  - `libraries/XunfeiFaceAPI`: 讯飞人脸识别实现。
  - `libraries/XunfeiOCRAPI`: 讯飞 OCR 实现。
  - `libraries/K10ImageProcessor`: 图像处理辅助类。
  - `libraries/countUtf8Characters`: UTF-8 字符串算法库。
  - `main.ts`: Mind+ 积木定义文件。
- `config.json`: 扩展库配置文件。

## ⚠️ 注意事项

- **网络连接**: 本库的大部分 AI 功能依赖于网络请求，请确保 K10 设备已连接互联网。
- **API 配额**: 使用科大讯飞 API 需要自行注册账号并获取 APPID/APIKey，注意免费额度限制。
- **内存管理**: 图片 Base64 编码占用内存较大，建议处理小分辨率图片以避免 ESP32 内存溢出。

## 📄 许可证

MIT License
