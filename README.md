# 智能博物项目功能库 (Yang-AI-thirdex)

**项目名称**: 智能博物项目功能库 (ZHINENFBOWU Project Function Library)  
**版本**: 0.2.0  
**作者**: YangAI  
**适用平台**: Mind+ (扩展库)  
**适用硬件**: UNIHIKER K10 (ESP32-S3)

## 📖 项目简介

这是一个为 **2026年智能博物项目** 开发的 Mind+ 第三方扩展库。它封装了 K10 设备在实现智能任务时所需的各类高级功能，实现了强大的本地 AI 服务支持（文本/图像分类、本地 OCR）以及优化的摄像头数据流传输方案。

主要目标是简化复杂的 API 调用和数据处理流程，让用户通过图形化积木即可轻松使用各类 AI 服务。

## ✨ 主要功能

### 1. 本地 AI 服务 (LocalClassifier) **[NEW]**
连接局域网内的 Python AI 服务器，实现低延迟、低成本的智能识别：
- **本地图像分类**: 直接将摄像头画面以二进制流形式传输至服务器进行分类。
- **本地 OCR 识别**: 支持原始图像流上传，服务器端进行文字识别（支持旋转矫正）。
- **本地文本分类**: 发送文本内容进行意图识别或分类。
- **百度 AI 代理**: 通过本地服务器代理转发请求至百度 AI 开放平台（OCR、人脸搜索、人脸属性检测），解决 HTTPS 握手慢和内存不足问题。

### 2. 图像处理与传输优化
- **二进制流直传**: 采用 `OptimizedCameraUpload` 方案，直接从摄像头缓冲区读取 JPEG 数据并通过 HTTP POST 发送，无需 Base64 编码，内存占用降低 33% 以上。
- **格式转换**: 支持 BMP 转 JPG Base64（用于传统接口）。

### 3. 工具箱 (String Utils)
针对 UTF-8 编码的中文字符串处理工具：
- **字符计数**: 正确计算包含中文的字符串长度。
- **字符获取**: 获取指定位置的中文字符。
- **索引查找**: 查找特定中文字符在字符串中的位置。

## 🧩 积木说明

本扩展库在 Mind+ 中提供以下积木类别：

### 初始化配置
- `设置本地服务器地址[...]`: 初始化本地 AI 服务连接。

### 本地 AI 识别
- `本地图像分类 (Raw)`: 拍摄并上传图片进行分类。
- `本地 OCR 识别 (Raw) 旋转角度[...]`: 拍摄并识别文字，支持设置旋转角度 (0/90/180/270)。
- `百度 AI 代理 [OCR/人脸搜索/人脸检测]`: 通过本地代理调用百度 AI 服务。


### 字符串工具
- `中文[...]的字符数`: 字符串长度计算。
- `中文[...]的第[...]个字符`: 字符提取。

## 🚀 快速开始

1. **部署本地服务器**:
   - 在电脑或服务器上运行配套的 Python 脚本（基于 Flask/FastAPI）。
   - 确保服务器 IP 与 K10 在同一局域网段。

2. **安装扩展**:
   - 打开 Mind+ -> “扩展” -> “用户库” -> 导入本库。

3. **硬件准备**:
   - 连接 UNIHIKER K10。
   - 确保 Wi-Fi 连接正常。

4. **编写程序**:
   - 使用 `初始化` 积木连接服务器。
   - 调用 `本地 OCR` 或 `本地图像分类` 积木获取结果。

## 📂 目录结构

- `arduinoC/`: 核心 C++ 源码及库文件。
  - `libraries/LocalClassifier`: **[核心]** 本地 AI 服务客户端，支持 Raw 数据上传。
  - `libraries/OptimizedCameraUpload`: **[核心]** 优化的摄像头二进制流上传库。
  - `libraries/countUtf8Characters`: UTF-8 字符串算法库。
  - `main.ts`: Mind+ 积木定义文件。
- `config.json`: 扩展库配置文件。

## ⚠️ 注意事项

- **网络要求**: 本地 AI 功能要求 K10 与服务器在同一局域网内。
- **服务器配置**: 请确保本地服务器已开启并监听正确端口（默认 8088），且防火墙允许入站连接。
- **内存优化**: 推荐优先使用带有 `(Raw)` 标识的积木，它们使用二进制流传输，比 Base64 方式更稳定、更快速。

## 📄 许可证

MIT License
